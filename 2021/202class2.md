# クラスとメソッド: 演算子オーバーロード

前回は、クラスとメソッド定義を勉強しました。

**演算子オーバーロード (operator overloading)** とは、特殊なメソッドを定義することで、演算子を拡張するオブジェクト指向プログラミングの技法です。

### Pythonにおける演算子

まず、Python において、そもそも演算子がどのように実装されているか、確認するところから始めましょう。

Python は、純粋なオブジェクト指向プログラミング言語なので、全ての値はオブジェクトになっています。`1`という整数値も、実は`int`クラスのオブジェクトです。

```py
type(1)
```

オブジェクトへの操作は、全てメソッドを通して行われます。加算は、`__add__(x)`という特殊なメソッドを呼び出した結果です。

```py
(1).__add__(2)
```

毎回、`(1).__ add__(2)`のように書くのはつらいので、メソッドコールの**シンタックスシュガー** として、`1+2`が用意されているわけです。

<div class="alert alert-info">

**シンタックスシュガー（糖衣構文）**

機械的に置き換えられる簡易記法

</div>

とういことで、`__add__(self, x)`を定義すれば、加算演算子を定義することができます。

|メソッド名 | 演算子|
|----|----|
|`x.__add__(y)` | `x + y`|
|`x.__sub__(y)` | `x - y`|
|`x.__mul__(y)` | `x * y`|
|`x.__truediv__(y)` | `x / y`|
|`x.__floordiv__(y)` | `x // y`|

Pythonでは、上記以外にもほぼ全ての[演算子](https://docs.python.org/ja/3/library/operator.html)がオーバーロードすることができます。


<div class="admonition tip">

**例題（空間上の点の加算）**

空間上の点 P, Q をベクトルとして加算できるようにメソッドを追加してみよう。

__例__

```
p = Point3D(1.0, 2.0, 3,0)
q = Point3D(4.0, 4.0, 4.0)
r = p + q
print('点R', r)
```
</div>


Point3D クラスに、以下のメソッドを追加します。 
   
```
    
    # 以下を追加する
    def __add__(self, a): 
        x = self.x + a.x
        y = self.y + a.y
        z = self.z + a.z 
        return Point3D(x, y, z)
```

## 有理数 

[有理数](https://ja.wikipedia.org/wiki/有理数)とは、２つの整数 $a$, $b$ (ただし $b$ は $0$ でない)をもちいて、
```math
\frac{a}{b}
```
という分数で表せる数。 $b = 1$ とすることにより、任意の整数は有理数となる.


<div class="admonition tip">

**コースワーク（有理数）**

有理数をクラスで定義してみよう。

1. 有理数クラスを定義する (クラス名は、`Q`とする)
2. クラス`Q`をインスタンス化し表示できるようにする。例えば、`Q(1,2)`は、`1/2`と表示される. `Q(2,1)`は、`2`となる。
3. 約分も忘れずに: `Q(2,4)`は、`1/2`となる。
4. 加算できるようにする。`Q(1, 2) + Q(1, 3)`は、`5/6`になる
5. 四則演算を全部、実装する
6. (上級者向け) 有理数の演算に整数を混ぜられるようにする. `Q(1,2)/2`は、`1/4`となる。

</div>

